---
description: 该规则解释了 Python 编码、最佳实践、 整洁高效的代码模式.
globs: **/*.py
alwaysApply: false
---

## 基本原则
- 遵循 **PEP 8** 风格指南与命名约定。
- 使用 **类型注解** 提升代码可读性与类型安全性。
- 使用 **文档字符串（docstring）** 清晰记录函数、类和模块用途。
- 每次写完代码使用 **make run** 进行错误扫描

## 依赖与环境管理
- 使用虚拟环境管理依赖：
  - 使用 **uv** 进行环境隔离。
  - 使用 `pyproject.toml` 记录依赖版本。
- 在开发、测试、生产环境保持依赖一致。
- 在调试代码时使用 uv 进行调试，避免直接运行python进行调试

## 代码风格与模式
- 优先使用：
  - 列表推导式、生成器表达式、字典推导式。
  - 上下文管理器（如 `with open(...)`）安全管理资源。
- 遵循 **面向对象设计原则（SOLID）**，保持模块内聚、耦合度低。
- 使用 `dataclasses` 或 `pydantic` 定义数据模型，减少样板代码。

## 测试与健壮性
- 使用 **pytest** 编写测试，保持高测试覆盖率。
- 使用 **异常处理** 保证程序健壮性，并合理记录错误日志。

## 通用礼节 (General Etiquette)
- 优先保证代码简洁易懂。
- 别搞过度设计，简单实用就好。
- 写代码时，要注意圈复杂度，函数尽量小，尽量可以复用，尽量不写重复代码。
- 写代码时，注意模块设计，尽量使用设计模式。
- 给我解释代码的时候，说人话，别拽专业术语。最好有图（mermaid风格）
- 帮我实现的时候，需要给出原理，并给出执行步骤，最好有图（mermaid风格）
- 改动或者解释前，最好看看所有代码，不能偷懒。
- 改动前，要做最小化修改，尽量不修改到其他模块的代码
- 改动后，假定10条case 输入，并给出预期结果
- 给出的mermaid图，必须自检语法，可以被渲染，在暗黑主题上清晰可见
- 给出的mermaid图，必须要可以被暗黑主题渲染清晰

# 实验性规则 (Experimental Rule)
当你被要求修复一个 Bug 时，请遵循以下步骤：
1.  **理解问题 (Understand):** 仔细阅读 Bug 描述和相关代码，复述你对问题的理解。
2.  **分析原因 (Analyze):** 提出至少两种可能的根本原因。
3.  **制定计划 (Plan):** 描述你打算如何验证这些原因，并给出修复方案。
4.  **请求确认 (Confirm):** 在动手修改前，向我确认你的计划。
5.  **执行修复 (Execute):** 实施修复。
6.  **审查 (Review):** 查看自己的修改有没有问题。
7.  **解释说明 (Explain):** 解释你做了哪些修改以及为什么。


Always respond in 中文